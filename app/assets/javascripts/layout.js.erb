$(function() {
	initialize_slider();
	function initialize_slider() {
		var num_slides = $("#slider article").length;
		var header_width = $("#slider article header").outerWidth(true);
		var container_width = $("#slider").outerWidth(true);
		var slide_width = (container_width - ((num_slides - 1) * header_width)) / container_width * 100;
		
		// set the width of the slider content
		$("#slider article").css("width", slide_width + "%");
		// display all of the collapsed article headers at the correct distance apart
		$("#slider article.collapsed").show();
		$("#slider article.collapsed").css("width", header_width + "px");
		$("#slider article.collapsed").each(function(i) {
			$(this).css("right", (header_width * (i)) + "px");
		});
	}

	$("#main-nav li a.active");

	$("#home-link").hover(function() {
		$li = $(this);
		$img = $(this).find("img");
		if(!$li.hasClass("active")) {
			$img.attr("src", "/assets/home-active.png");
		}
	}, function() {
		if(!$li.hasClass("active")) {		
			$img.attr("src", "/assets/home.png");			
		}
	});

	$("#main-nav li a").hover(function() {
		$(this).closest("li").addClass("hover");
	}, function() {
		$(this).closest("li").removeClass("hover");
	});

	$(document).pjax("#services a.btn", "#main-content");

	$("#services a.btn").click(function() {
		$("#main-content").css("opacity", "0.3");
		$("body").append("<div id='spinner'></img>")

		$("#spinner").css("top", $("#main-content").offset().top + 100);
		$("#spinner").css("left", $("#main-content").offset().left + ($("#main-content").width() / 2) - 60);
		$('html, body').animate({
			scrollTop: $("#main-content").offset().top
		}, 800);		
	});

	$(document).on("pjax:success", function(xhr, data){
		$("#main-content").html(data);
		$("#main-content").css("opacity", "1");
		$("#spinner").remove();
	});
});